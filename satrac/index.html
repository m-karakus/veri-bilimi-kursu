<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Satran√ß Oyunu</title>
</head>

<body>


<script>
    // Generate piece codes from a given string or directly from a FEN string
    function generatePieceCodesFromString(inputString) {
        const codes = [];
        for (let i = 0; i < inputString.length; i++) {
            codes.push(inputString.charCodeAt(i) - 64);
        }
        return codes;
    }

    // Generate piece codes from FEN notation (for now, equivalent to original logic)
    function generatePieceCodesFromFEN(fen) {
        // Placeholder logic: you can expand this to parse a real FEN string
        return generatePieceCodesFromString("ustvrtsuqqqqqqqqyyyyyyyy}{|~z|{}@G@TSb~?A6J57IKJT576,+-48HLSUmgukgg OJNMLK  IDHGFE");
    }

    // Piece codes generated from FEN or string
    let pieceCodes = generatePieceCodesFromFEN("your-fen-string-here");

    // Initialize variables
    let y = 0, u = 0, b = 0;
    const boardSize = 10, maxMoves = 15;
    let boardState = [];

    // Populate the boardState
    for (let cellIndex = 0; cellIndex < 120; cellIndex++) {
        boardState[cellIndex-1] =
            cellIndex % boardSize
                ? cellIndex / boardSize % boardSize < 2 || cellIndex % boardSize < 2
                    ? 7
                    : cellIndex / boardSize & 4
                    ? 0
                    : pieceCodes[u++]
                : 7;
    }

    // Main calculateMove function
    function calculateMove(playerColor, depth, lastPosition, maxDepth, evaluation) {
        playerColor ^= 8;
        for (
            var T, o, L, E, D, O = 20, G, N = -1e8, n, g, d = maxDepth && calculateMove(playerColor, 0) > 1e4,
                C, R, A, K = 78 - depth << 9, a = playerColor ? boardSize : -boardSize;
            ++O < 99;
        ) {
            if ((o = boardState[T = O]) && (G = o & maxMoves ^ playerColor) < 7) {
                A = G-- & 2 ? 8 : 4;
                C = 9 - o & maxMoves ? pieceCodes[61 + G] : 49;
                do {
                    R = boardState[T += pieceCodes[C]];
                    g = D = G | T + a - lastPosition ? 0 : lastPosition;
                    if (!R && (G || A < 3 || g) || (1 + R & maxMoves ^ playerColor) > 9 && G | A > 2) {
                        if (!(2 - R & 7)) return K;
                        for (E = n = G | boardState[T - a] - 7 ? o & maxMoves : 6 ^ playerColor; E; E = !E && !d && !(g = T, D = T < O ? g - 3 : g + 2, boardState[D] < maxMoves | boardState[D + O - T] | boardState[T += T - O])) {
                            L = (R && pieceCodes[R & 7 | 32] * 2 - depth - G) + (G ? 0 : n - o & maxMoves ? 110 : (D && 14) + (A < 2) + 1);
                            if (maxDepth > depth || 1 < maxDepth & maxDepth == depth && L > 2 | d) {
                                boardState[T] = n, boardState[g] = boardState[D], boardState[O] = D ? boardState[D] = 0 : 0;
                                L -= calculateMove(playerColor, depth + 1, E = G | A > 1 ? 0 : T, maxDepth, L - N);
                                if (!(depth || maxDepth - 1 | cellIndex - O | T - b | L < -1e4)) return renderBoard(y = E), playerColor && setTimeout("calculateMove(8,0,y,2),calculateMove(8,0,y,1)", 75);
                                E = 1 - G | A < 7 | D | !maxDepth | R | o < maxMoves || calculateMove(playerColor, 0) > 1e4;
                                boardState[O] = o;
                                boardState[T] = R;
                                boardState[D] = boardState[g];
                                D ? boardState[g] = G ? 0 : 9 ^ playerColor : 0;
                            }
                            if (L > N || !depth & L == N && Math.random() < .5) if (N = L, maxDepth > 1) if (depth ? evaluation - L < 0 : (cellIndex = O, b = T, 0)) return N;
                        }
                    }
                } while (!R & G > 2 || (T = O, G | A > 2 | maxMoves < o & !R && ++C * --A));
            }
        }
        return -K + 768 < N | d && N;
    }

    // Render the board
    function renderBoard() {
        let i = "<table>";
        for (u = 18; u < 98; document.body.innerHTML = i += ++u % boardSize - 9 ? "<th width=60 height=60 onclick='boardState[b=" + u + "]&8?renderBoard():calculateMove(0,0,y,1)' style='font-size:50px' bgcolor=#" + (u - cellIndex ? u * .9 & 1 || 9 : "d") + "0f0e0>&#" + (boardState[u] & 15 ? 9808 + pieceCodes[67 + (boardState[u] & 15)] : 160) + ";" : u++ && "<tr>") cellIndex = b;
    }
    renderBoard();
</script>

</body>

</html>